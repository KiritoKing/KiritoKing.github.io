---
title: 个人网站搭建记录
excerpt: 使用 Hexo+React 搭建个人静态博客系统的个人经验总结
cover: https://images.unsplash.com/photo-1665686304129-a6e2d16923e8?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1470&q=80
thumbnail: https://images.unsplash.com/photo-1665686304129-a6e2d16923e8?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1470&q=80
abbrlink: 1933027073
tags:
  - 个人博客
  - Hexo
  - 网站搭建与部署
categories:
  - 前端
date: 2023-04-22 21:36:00
---

## 技术选型

在做博客之前先了解了一下国内已有的博客平台，因为其在**SEO和曝光**方面有一定的先天优势：

- CSDN：老牌国内社区，现在全是广告和复制粘贴翻译的低创，还拿开源资料来收费，还把导入MD的功能砍了，直接Pass
- 知乎：问答社区，编写体验尚可，之前在上面写过几篇NLP的文章，内容质量有点参差不齐，但还是有有价值的东西
- 掘金/思否：查资料的时候经常看别人的文章，感觉这两家的内容质量还不错，观看体验尚可，但没在上面写过
- 博客园：默认样式很丑，需要（个人直觉）在线配置有点麻烦，但自由度高，有SEO优化，部署相对方便（特别是对国内这种需要公安备案的环境）
- ~~新浪：已经死啦~~

目前国外我了解的开放博客解决方案有：

- WordPress：功能大而全，个人感觉属于重型框架
- Hexo：Node.JS框架，自定义程度高，JSON数据库，轻型框架
- Hugo：未作了解

最终，个人出于熟悉程度，之前也做过Hexo相关博客平台的外包，选择了**Hexo**平台。

对个人而言，**Hexo有以下优点**：

- 管理方便，自动更新和渲染MD文档
- 使用NodeJS作为平台，方便自定义和维护
- 部署较方便，社区支持好，可以一键部署到Github Page或其他静态网站托管服务

## 博客架构

Hexo采用`hexo-6.3.0`和`node-v16.17.1`在本地构建，主题使用 [Redefine](https://github.com/EvanNotFound/hexo-theme-redefine)（可能后续会进行改动和二次开发）。

在整个博客中，Hexo作为**静态网站框架**，起到**Hold整个Markdown博客数据库并渲染成HTML**、**渲染其他静态网页**两个作用。

### Hexo 配置

参考我之前的项目 [KiritoKing/hexo-msdoc-renderer](https://github.com/KiritoKing/hexo-msdoc-renderer)，为博客增加以下基础功能：

- 根据目录自动添加分类，由插件[xu-song/hexo-auto-category](https://github.com/xu-song/hexo-auto-category)实现
- 为每个页面生成独立URL来替代原有Path，由插件[rozbo/hexo-abbrlink](https://github.com/rozbo/hexo-abbrlink)实现
- 修改默认渲染器为[hexojs/hexo-renderer-markdown-it](https://github.com/hexojs/hexo-renderer-markdown-it)提供更多MD拓展语法支持
- [图片上传到COS图床](#图床配置)中，由本地编辑器（Typora）实现
- ~~根据文档编辑时间自动编辑date的front-matter（开发中）~~

### 部署方案

- 源码部署到Github仓库，方便多端同步
- 网站托管使用腾讯云的静态网站托管服务（按量计费），绑定到自己域名（需要备案）
- 评论实现采用[gitalk](https://github.com/gitalk/gitalk)实现

### 其他页面

由于除了博客，个人网站还需要显示其他页面，这里有以下两个解决方案：

- 方案A：直接在`./source`中创建对应目录映射为URL，将单页面静态网站放在目录中，使用`_config.yml`中的`skip_render`选项跳过渲染（生成时直接拷贝到`public`中）
- 方案B：Fork主题，添加指定页面的Scaffold代码，利用`./_data`动态渲染页面，模板EJS设计完成后PR

方案A适用于不会经常改变的静态页面，如个人简历；方案B适用于动态页面，如项目列表，可能需要用Github抓取信息更新`yml`文件来刷新页面。

### Hexo 主题备选

因为做过不少Hexo外包项目，这里收集了一些我个人觉得不错的主题：

- [zhwangart/hexo-theme-acorn:](https://github.com/zhwangart/hexo-theme-acorn)：适用于中小型企业门户
- [volantis-x/hexo-theme-volantis](https://github.com/volantis-x/hexo-theme-volantis)：适合开放式博客平台（多人共建）
- [EvanNotFound/hexo-theme-redefine](https://github.com/EvanNotFound/hexo-theme-redefine)：适合个人展示型博客
- [nexmoe/hexo-theme-yet-the-books](https://github.com/nexmoe/hexo-theme-yet-the-books)：适合偏文学创作

### 后续开发计划

- 若遇到性能瓶颈则转投 Next+SSR 的方案
- 目前打算开发一个**Hexo的GUI管理方案**（基于React+Next/Electron），不过不是编辑器类型而是偏管理，目前规划了以下功能
  - Git推送管理功能
    - 一键Add+Commit+Push/Deploy，并自动生成对应Log信息
    - 根据Git Log信息自动更新文章Date
  - 推文管理
    - Draft可视化管理和发布管理
    - Front-Matter管理
    - 推文编写计划管理（结合Draft）
  - 支持Electron独立客户端和Web页面形式的Hexo插件两种形态
- 

## Typora 配置

我一直都习惯用 Typora 进行写作，习惯了所以也入了正版~~（其实是当时不知道beta可以一直用~~。

### 图床配置

之前一直用的picgo的GUI客户端，因为最开始接触MD写作的时候并不会写前端和Node那一块，所以就用了gui，但越到后面越发现这个electron的客户端就是个性能累赘：不仅冷启动速度慢还经常卡死，而且是一个根本不必要的功能（指上传完全可以用cli实现），所以就借此机会切换到picgo-core。

> 切换到CLI后可以做到**0秒冷启动**的效果，非常顺滑，而且**没有一个额外的electron进程占后台**。本文所有图片均使用picgo-core上传。

首先你先要有一个包管理器（npm, yarn, pnpm）都可以：

```shell
# 这里以npm为例
npm i picgo -g
```

然后是配置图床，个人使用的是**腾讯云COS**作为图床：

1. 在[访问密钥](https://console.cloud.tencent.com/cam/capi)中获取你的AppId, SecretId, SecretId；在[存储桶列表](https://console.cloud.tencent.com/cos/bucket)获取Bucket和AP位置。
2. 建议在终端中运行 `picgo set uploader`运行CLI向导，运行完毕后你的配置文件应如下图所示：

![image-20230522214210799](https://picgo-1308055782.cos.ap-chengdu.myqcloud.com/picgo-core/image-20230522214210799.png)

![image-20230522214653844](https://picgo-1308055782.cos.ap-chengdu.myqcloud.com/picgo-core/image-20230522214653844.png)

3. 在Typora中 设置 -> 图像 设置好上传服务（如果你前面配置好了就可以直接验证，也可以打开配置文件检查一下）

![image-20230522214546431](https://picgo-1308055782.cos.ap-chengdu.myqcloud.com/picgo-core/2023/05/20230522221603.png)

上传成功会得到如下提示：

![image-20230522214745134](https://picgo-1308055782.cos.ap-chengdu.myqcloud.com/picgo-core/20230522221527.png)

4. **配置时间戳上传**，这里需要借用 [picgo-plugin-super-prefix](https://github.com/gclove/picgo-plugin-super-prefix) 这个插件。

首先全局安装这个包：

```shell
picgo install super-prefix
```

然后在配置文件里添加和修改下面的代码，就可以让图片存储在对应存储桶的`YYYY/MM/YYYYMMDDHHmmss.*`路径里（如`*/picgo-core/2023/05/20230522221603.png`）：

```json
{
	"picgoPlugins": {
    	"picgo-plugin-super-prefix": true
  	},
  	"picgo-plugin-super-prefix": {
        "prefixFormat": "YYYY/MM/",
        "fileFormat": "YYYYMMDDHHmmss"
  	}
}
```







---

## 参考链接

- [使用 Next.js + Hexo 重构我的博客 | Sukka's Blog (skk.moe)](https://blog.skk.moe/post/use-nextjs-and-hexo-to-rebuild-my-blog/#Nei-Rong-Guan-Li-Cong-Hexo-Dao-Next-js)
- [通过Hexo + Github Pages部署你的react项目 - 掘金 (juejin.cn)](https://juejin.cn/post/7208946311885586492)
- [Typora + PicGo-Core + 腾讯云COS 图床配置 - MrSu - 博客园 (cnblogs.com)](https://www.cnblogs.com/suguangti/p/14702744.html)
- [快速上手 | PicGo-Core](https://picgo.github.io/PicGo-Core-Doc/zh/guide/getting-started.html)
- [Upload Images - Typora Support (typoraio.cn)](https://support.typoraio.cn/Upload-Image/#picgo-core-command-line-opensource)
- [Picgo上传图片添加时间戳前缀_picgo super prefix_葡萄汁suki的博客-CSDN博客](https://blog.csdn.net/qq_42365842/article/details/124693106)