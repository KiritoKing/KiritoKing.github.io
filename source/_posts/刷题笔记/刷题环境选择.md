---
title: 关于刷题环境的看法与选择
abbrlink: 1890791615
tags:
  - 开发环境
  - c/c++
  - java
  - python
  - js
  - ts
  - c#
categories:
  - 刷题笔记
date: 2023-04-12 00:00:00
---

### 刷题环境的选择标准

今天在准备机试，拿起很久没刷的算法题（上次刷题还是大一刷洛谷），除了考虑刷哪一套题单，要考虑的就是**使用什么语言、什么环境**来刷。

由于线上环境与本地环境有较大区别，而面向机试的刷题练习应该尽量做到与线上环境保持一致，因此我提出了本地环境的以下几点基本要求：

- 尽量使用**编辑器+单文件（脚本）**的方式而非IDE+项目的模式

- 编译运行过程尽量简单，且支持单步调试，做到编写体验不拖后腿
- 语言运行速度不拖后腿
- 不应提供过多功能（如Copilot）

满足以上的标准有如下几个**语言+环境**选择（均搭配Windows下的VS Code编辑器）：

- C++ + G++/Clang
- C# + .NET Core
- Java + openJDK
- Python3 + CPython
- JS/TS + NodeJS

### 各个环境的利弊权衡

#### C++

于刷题而言，C++肯定是最好的选择，性能优异，无GC无运行时，兼容C语法，编写方便，还有STL和O2优化魔法，众多OIer的一致选择。

但是C++有一个大问题，就是**现代C++（>=C++20）和古法C++（一般指98标准）完全是两种语言**，一般OIer指的是古法C++，而且在线平台也不清楚编译器对C++10的支持怎么样（当然其他语言也一样）。

最终个人不选择C++的主要原因有下：

- 个人很久没有使用C++，对刷题来讲对库的熟悉程度肯定是不够的
- C++轮子和语法糖少，还有一些历史遗留问题（如羸弱的std::string）
- C++的命名空间管理相对于Java和C#比较难用（虽然对刷题没什么影响）

对于熟悉C++的人，这里说明一下，C++仍是你刷题的**第一选择**。

#### Java

个人对Java的刻板印象其实在于擦除式泛型让Java的反射相比.NET很难用，但是这对刷题几乎没有影响。

至于老生常谈的GC和JVM调优这些问题，一方面对刷题根本没有影响，一方面新版本的JDK已经基本解决了这些问题（zGC和Native AOT）。

我本来以为Java和.NET性能应该是半斤八两的，毕竟个人体验下来在本地环境里.NET7其实会略快于Java11，但是刷题的实际成绩令我大跌眼镜。

#### C#

个人对C#的语法十分的喜好，新版语法糖也十分方便。

但微软的老毛病就是容易砍东西，新版本和旧版本之间有重复造轮子的可能，而且.NET的性能理论上和JVM是一个量级的，均弱于C++。

鉴于具体性能问题，这里不再推荐C#。

#### Python

个人对Python的刻板印象真的很深，虽然ML的轮子很多基本绕不开，我平时基本就把Python当C/C++的脚本前端来用。说说我的刻板印象吧：

- 无分号无大括号，靠空白字符和缩进组织语法树（这点真的不能忍啊）
- 半残废的TypeLint和Class让项目维护变得很困难
- 对库的兼容性不清楚（在线环境也没试过），每次搞ML的时候装完库发现版本问题真的很崩溃
- 原生数值运算（不用numpy）性能感人，函数调用开销夸张
- GIL废了多线程（虽然和刷题一点关系没有）

### JS/TS

作为半个前端/全栈狗，对JS/TS自然是很熟。

虽然V8解释器很快，但JS语言本身还有很多历史遗留问题，JS的各种奇怪特性如果影响到了做题就很难受。

而且用JS在刷题圈子里实在太少见了，遇到问题都搜不到那种。

### 实际性能表现

这里以搜索二维矩阵为例，以全部二分法解题作为Benchmark测试各平台性能。

在线平台：**LeetCode 2023/04/12**

解题代码如下（以C#为例）：

```c#
public class Solution {
    public bool SearchMatrix(int[][] matrix, int target) {
        if (matrix.Length == 0 || matrix[0].Length == 0) return false;
        int begin, mid, end;
        begin = mid = 0;
        int dim1 = matrix.Length, dim2 = matrix[0].Length;
        end = dim1 * dim2 -1;
        while (begin < end) {
            mid = (begin + end) / 2;
            if (matrix[mid/dim2][mid%dim2] < target) begin = mid + 1;
            else end = mid;
        }
        return matrix[begin/dim2][begin%dim2] == target;
    }
}
```

最终相同代码在不同语言下得到的成绩如下：

![image-20230412171451077](C:\Users\wps\AppData\Roaming\Typora\typora-user-images\image-20230412171451077.png)

可以看到：

- C#和Java作为带Runtime和GC的语言，内存占用在一个量级上
- Java运行时间发挥亮眼，.NET不知道什么原因大幅落后于Java（个人猜测是JIT冷启动）
- C++发挥稳定，内存占用一如既往的独一档，执行用时和Java在一个水平上
- Python表现令人意外（也可能是C#令人太意外了），处于中规中矩的水平

### 个人的其他困惑

关于在线平台个人最大的不满还是**运行环境的不透明性**，你不能直观地知道当前运行环境的SDK版本，也不知道相关配置（有没有开启特定优化）。

其次是在线编译器的**代码提示不完整**，**编译和Debug体验也不好**，与本地环境脱节比较严重。