function initTOC(){Global.utils.navItems=document.querySelectorAll(".post-toc-wrap .post-toc li");if(Global.utils.navItems.length>0){Global.utils={...Global.utils,updateActiveTOCLink(){if(!Array.isArray(Global.utils.sections))return;let e=Global.utils.sections.findIndex(e=>{return e&&e.getBoundingClientRect().top-200>0});if(e===-1){e=Global.utils.sections.length-1}else if(e>0){e--}this.activateTOCLink(e)},registerTOCScroll(){Global.utils.sections=[...document.querySelectorAll(".post-toc li a.nav-link")].map(e=>{const o=document.getElementById(decodeURI(e.getAttribute("href")).replace("#",""));e.addEventListener("click",e=>{e.preventDefault();const t=o.getBoundingClientRect().top+window.scrollY;window.anime({targets:document.scrollingElement,duration:500,easing:"linear",scrollTop:t-10,complete:function(){setTimeout(()=>{Global.utils.pageTop_dom.classList.add("hide")},100)}})});return o})},activateTOCLink(e){const t=document.querySelectorAll(".post-toc li a.nav-link")[e];if(!t||t.classList.contains("active-current")){return}document.querySelectorAll(".post-toc .active").forEach(e=>{e.classList.remove("active","active-current")});t.classList.add("active","active-current");const o=document.querySelector(".toc-content-container");const l=o.getBoundingClientRect().top;const n=o.offsetHeight>window.innerHeight?(o.offsetHeight-window.innerHeight)/2:0;const i=t.getBoundingClientRect().top-l;const s=Math.max(document.documentElement.clientHeight,window.innerHeight||0);const c=i-s/2+t.offsetHeight/2-n;const a=o.scrollTop+c;window.anime({targets:o,duration:300,easing:"easeOutQuad",scrollTop:a})},showTOCAside(){const e=()=>{const e=Global.getStyleStatus();const t="isOpenPageAside";if(e&&e.hasOwnProperty(t)){Global.utils.TocToggle.pageAsideHandleOfTOC(e[t])}else{Global.utils.TocToggle.pageAsideHandleOfTOC(true)}};const t="init_open";if(Global.theme_config.articles.toc.hasOwnProperty(t)){Global.theme_config.articles.toc[t]?e():Global.utils.TocToggle.pageAsideHandleOfTOC(false)}else{e()}}};Global.utils.showTOCAside();Global.utils.registerTOCScroll()}else{document.querySelectorAll(".toc-content-container, .toc-marker").forEach(e=>{e.remove()})}}if(Global.theme_config.global.pjax===true&&Global.utils){initTOC()}else{window.addEventListener("DOMContentLoaded",initTOC)}